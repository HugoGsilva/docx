# ==========================================
# Dockerfile para Desenvolvimento
# ==========================================
FROM node:18-slim

# Instalar LibreOffice e dependências para conversão PDF
RUN apt-get update && apt-get install -y \
    libreoffice \
    libreoffice-writer \
    fonts-liberation \
    fonts-dejavu \
    fontconfig \
    curl \
    && apt-get clean \
    && rm -rf /var/lib/apt/lists/*

# Atualizar cache de fontes
RUN fc-cache -fv

# Definir diretório de trabalho
WORKDIR /app

# Instalar concurrently globalmente
RUN npm install -g concurrently nodemon

# Copiar package.json raiz
COPY package*.json ./

# Copiar arquivos de dependências
COPY server/package*.json ./server/
COPY client/package*.json ./client/

# Instalar dependências
RUN cd server && npm install
RUN cd client && npm install

# Copiar código fonte
COPY . .

# Expor portas
EXPOSE 3001 5173

# Comando para desenvolvimento
CMD ["npm", "run", "dev"]
